<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="The surfaces of white blood cells are covered in receptors that act as three-dimensional puzzle pieces that only match proteins that are not native to the body."><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"><title>Designing Immune Receptors | grisha.log</title><!-- Theme detection: runs before render to prevent flash --><script>
      (function() {
        var stored = localStorage.getItem('theme');
        if (stored === 'dark' || (!stored && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark');
        }
      })();
    </script><link rel="stylesheet" href="/_astro/_slug_.YteoUFBk.css">
<style>:root{--post-text: #353535;--post-heading: #1a1a1a;--post-strong: #1a1a1a;--post-link: #2563eb;--post-link-hover: #1d4ed8;--post-code-bg: #f5f5f5;--post-pre-bg: #f7f7f7;--post-blockquote-border: #d4d4d4;--post-blockquote-text: #737373;--post-caption: #737373;--post-aside-bg: #f5f5f5;--post-aside-text: #737373;--post-separator: #e5e5e5}.dark{--post-text: #d4d4d4;--post-heading: white;--post-strong: white;--post-link: #93c5fd;--post-link-hover: #bfdbfe;--post-code-bg: #1c1c1c;--post-pre-bg: #141414;--post-blockquote-border: #525252;--post-blockquote-text: #a3a3a3;--post-caption: #a3a3a3;--post-aside-bg: #1c1c1c;--post-aside-text: #a3a3a3;--post-separator: #404040}.l-body{max-width:700px;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem}.l-page{max-width:900px;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem}.post{overflow-x:hidden}.l-screen{width:100vw;position:relative;left:50%;right:50%;margin-left:-50vw;margin-right:-50vw}.post-content figure.l-screen{margin-left:-50vw;margin-right:-50vw}.post-content{color:var(--post-text);line-height:1.8;font-size:1.125rem}.post-content h2{color:var(--post-heading);font-size:1.75rem;font-weight:700;margin-top:2.5rem;margin-bottom:1rem}.post-content h3{color:var(--post-heading);font-size:1.375rem;font-weight:600;margin-top:2rem;margin-bottom:.75rem}.post-content p{margin-bottom:1.25rem}.post-content strong{color:var(--post-strong);font-weight:600}.post-content a{color:var(--post-link);text-decoration:underline;text-underline-offset:2px}.post-content a:hover{color:var(--post-link-hover)}.post-content code{background:var(--post-code-bg);padding:.15rem .4rem;border-radius:.25rem;font-size:.9em}.post-content pre{background:var(--post-pre-bg);border-radius:.5rem;padding:1.25rem;overflow-x:auto;margin-bottom:1.25rem}.post-content pre code{background:none;padding:0}.dark .astro-code,.dark .astro-code span{color:var(--shiki-dark)!important;background-color:var(--shiki-dark-bg)!important}.post-content blockquote{border-left:3px solid var(--post-blockquote-border);padding-left:1rem;color:var(--post-blockquote-text);margin-bottom:1.25rem}.post-content ul,.post-content ol{padding-left:1.5rem;margin-bottom:1.25rem}.post-content li{margin-bottom:.5rem}.post-content img{border-radius:.25rem}.post-content figure{margin:2.5rem auto;text-align:center}.post-content figure:not(.l-body):not(.l-page):not(.l-screen){max-width:900px;position:relative;width:90vw;left:50%;transform:translate(-50%)}@media(min-width:940px){.post-content figure:not(.l-body):not(.l-page):not(.l-screen){width:900px}}.post-content figure img,.post-content figure video{margin-left:auto;margin-right:auto;margin-bottom:.75rem;max-width:100%;height:auto;border-radius:.25rem}.post-content figcaption{font-size:.85rem;color:var(--post-caption);line-height:1.5;text-align:center;max-width:540px;margin:0 auto}.post-content>p>img{display:block;margin:2rem auto;max-width:100%}.aside-container{position:relative}@media(min-width:1200px){.aside-note{position:absolute;right:-280px;width:240px;font-size:.85rem;color:var(--post-aside-text);line-height:1.5}}@media(max-width:1199px){.aside-note{background:var(--post-aside-bg);border-radius:.5rem;padding:.75rem 1rem;margin-bottom:1.25rem;font-size:.9rem;color:var(--post-aside-text)}}.post-content .katex{color:inherit}.post-separator{border:none;border-top:1px solid var(--post-separator)}
</style></head> <body class="bg-white dark:bg-black text-gray-900 dark:text-white font-sans min-h-screen">  <nav class="fixed top-0 w-full bg-white dark:bg-black z-50" role="navigation" aria-label="main navigation" data-lang="en"> <div class="max-w-6xl mx-auto px-4 flex items-center justify-between h-16"> <a href="/" class="font-bold text-gray-900 dark:text-white text-lg">grisha.log</a> <!-- Desktop nav --> <div class="hidden md:flex items-center gap-6 text-sm uppercase tracking-wide"> <a href="/" data-section="hero" class="nav-link text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">Home</a> <a href="/#blog" data-section="blog" class="nav-link text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">Blog</a> <a href="/#contact" data-section="contact" class="nav-link text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">Contact</a> <a href="/ja/blog/designing-immune-receptors/" aria-label="Switch to Japanese" class="p-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"> <span class="block w-5 h-5 leading-5 text-center text-xs font-bold">JP</span> </a> <button type="button" aria-label="Toggle dark mode" class="theme-toggle p-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"> <!-- Sun (shown in dark mode: click to go light) --> <svg class="hidden dark:block w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path> </svg> <!-- Moon (shown in light mode: click to go dark) --> <svg class="block dark:hidden w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path> </svg> </button> <script type="module">document.querySelectorAll(".theme-toggle").forEach(e=>{e.addEventListener("click",()=>{const t=document.documentElement.classList.toggle("dark");localStorage.setItem("theme",t?"dark":"light")})});</script> </div> <!-- Mobile: toggle + burger --> <div class="flex items-center gap-2 md:hidden"> <a href="/ja/blog/designing-immune-receptors/" aria-label="Switch to Japanese" class="p-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"> <span class="block w-5 h-5 leading-5 text-center text-xs font-bold">JP</span> </a> <button type="button" aria-label="Toggle dark mode" class="theme-toggle p-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"> <!-- Sun (shown in dark mode: click to go light) --> <svg class="hidden dark:block w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path> </svg> <!-- Moon (shown in light mode: click to go dark) --> <svg class="block dark:hidden w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path> </svg> </button>  <button class="text-gray-900 dark:text-white" id="nav-burger" aria-label="Toggle navigation" aria-expanded="false"> <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </button> </div> </div> <!-- Mobile menu --> <div class="hidden md:hidden bg-white dark:bg-black px-4 pb-4" id="nav-menu"> <a href="/" data-section="hero" class="nav-link block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">Home</a> <a href="/#blog" data-section="blog" class="nav-link block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">Blog</a> <a href="/#contact" data-section="contact" class="nav-link block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">Contact</a> </div> </nav> <script type="module">const o=document.getElementById("nav-burger"),i=document.getElementById("nav-menu");o?.addEventListener("click",()=>{i?.classList.toggle("hidden");const t=o.getAttribute("aria-expanded")==="true";o.setAttribute("aria-expanded",String(!t))});i?.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>{i.classList.add("hidden"),o?.setAttribute("aria-expanded","false")})});const l=document.querySelectorAll(".nav-link");function c(t){l.forEach(n=>{const e=n.dataset.section===t;n.classList.toggle("text-gray-900",e),n.classList.toggle("dark:text-white",e),n.classList.toggle("text-gray-500",!e),n.classList.toggle("dark:text-gray-400",!e)})}const r=["/","/ja/","/ja"],g=r.includes(window.location.pathname),d=["hero","blog","contact"],s=g?d.map(t=>document.getElementById(t)).filter(Boolean):[];if(s.length===d.length){let t=function(){const n=window.scrollY+window.innerHeight*.35;let e=s[0].id;for(const a of s)a.offsetTop<=n&&(e=a.id);window.innerHeight+window.scrollY>=document.body.offsetHeight-2&&(e="contact"),c(e)};window.addEventListener("scroll",t,{passive:!0}),t()}else window.location.pathname.includes("/blog")&&c("blog");</script> <article class="post"> <header class="l-body pt-32 pb-8"> <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4 tracking-tight">Designing Immune Receptors</h1> <p class="text-gray-600 dark:text-gray-400 text-lg leading-relaxed mb-4">The surfaces of white blood cells are covered in receptors that act as three-dimensional puzzle pieces that only match proteins that are not native to the body.</p> <div class="flex items-center gap-4 text-gray-500 text-sm"> <time datetime="2023-11-01T00:00:00.000Z">November 1, 2023</time> <div class="flex gap-2"> <span class="bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-xs">immunology</span><span class="bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-xs">machine-learning</span><span class="bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-xs">protein-design</span><span class="bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-xs">blender</span> </div> </div> </header> <div class="post-content l-body">  <h3 id="signals-of-cancer-can-appear-on-the-surface-of-tumour-cells">Signals of cancer can appear on the surface of tumour cells</h3>
<p>Healthy cells present fragments of their proteins, called peptides, on their surface. These peptides are held in place by molecules called MHC. When a cell acquires a mutation that causes it to behave like a tumour cell, there is a chance that the mutation in question gets presented by the MHC. When this happens, white blood cells have an opportunity to recognise the mutated peptide with the receptors on its surface.</p>
<figure><img src="/images/pmhc-2.png" width="128" alt="pMHC variant 2"/><img src="/images/pmhc-3.png" width="128" alt="pMHC variant 3"/><img src="/images/pmhc-4.png" width="128" alt="pMHC variant 4"/><img src="/images/pmhc-5.png" width="128" alt="pMHC variant 5"/><figcaption>A mutation (black) appears in the peptide (white) presented by an MHC molecule (cyan)</figcaption></figure>
<h3 id="designing-receptors-that-match-the-cancer-signal-but-not-healthy-cells-is-hard">Designing receptors that match the cancer signal, but not healthy cells, is hard</h3>
<p>Finding white blood cell receptors that bind to the mutated peptide and not the healthy variant is difficult because often there is only one amino acid difference between healthy and cancerous. If cells bind the healthy variant there is a risk that they will attack healthy cells, generating an auto-immune response.</p>
<p>This is where AI can be used to navigate the search space of the white blood cell receptor sequences (<a href="https://openreview.net/forum?id=YOGss3XXp0">L. Cornwall, G. Szep et al. 2023</a>). By training models to predict which amino acids best the surface of the MHC, we can restrict the search space for amino acid sequences in the loop regions of the receptor that are responsible for recognising diseased cells.</p>
<figure><img src="/images/tcr-1.png" width="128" alt="TCR variant 1"/><img src="/images/tcr-2.png" width="128" alt="TCR variant 2"/><img src="/images/tcr-3.png" width="128" alt="TCR variant 3"/><img src="/images/tcr-4.png" width="128" alt="TCR variant 4"/><figcaption>A white blood cell receptor (red) is generated with the help of AI to match the shape of the mutated peptide presented on the MHC</figcaption></figure>
<h3 id="using-blender-to-visualise-the-combinatoric-complexity">Using Blender to Visualise the Combinatoric Complexity</h3>
<p>The generative model produces <a href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/tutorials/pdbintro.html">PDB Files</a> that look like this</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext"><code><span class="line"><span>ATOM      1  N   GLY A   1     -17.507  12.508  39.735  1.00 56.47           N</span></span>
<span class="line"><span>ATOM      2  CA  GLY A   1     -16.155  12.561  40.353  1.00 60.73           C</span></span>
<span class="line"><span>ATOM      3  C   GLY A   1     -15.103  12.063  39.385  1.00 59.90           C</span></span>
<span class="line"><span>ATOM      4  O   GLY A   1     -15.449  11.565  38.306  1.00 61.33           O</span></span>
<span class="line"><span>ATOM      5  N   SER A   2     -13.833  12.192  39.769  1.00 56.73           N</span></span>
<span class="line"><span>...</span></span></code></pre>
<p>Each line contains the coordinates of an atom, which species it is, and which chain and amino acid it belongs to. It is possible to import these files into Blender using the amazing <a href="https://bradyajohnston.github.io/MolecularNodes/">Molecular Nodes</a> add-on. This add-on allows you to use Geometry Nodes to render desired properties using any of the information available in the PDB file.</p>
<h3 id="references">References</h3>
<p>L. Cornwall, G. Szep et al. 2023. NeurIPS Generative AI &amp; Biology Workshop. Fine-tuned protein language models capture T cell receptor stochasticity</p>
<p>B.A. Johnston. 2024. MolecularNodes. zenodo.org/records/11483365</p>  </div> <div class="l-body pb-16 pt-12"> <hr class="post-separator"> </div> </article> <footer id="contact" class="bg-gray-100 dark:bg-gray-800" style="scroll-margin-top: 4rem;"> <div class="max-w-6xl mx-auto px-4 py-12"> <div class="flex flex-col md:flex-row items-center md:items-start gap-6"> <img src="/images/headshot.jpg" alt="Grisha Szep" class="w-16 h-16 rounded-full object-cover"> <div class="text-center md:text-left"> <h3 class="text-gray-900 dark:text-gray-300 font-medium">Grisha Szep</h3> <p class="text-gray-500 text-sm mt-1 max-w-lg">Grisha Szep builds cognitive cyberware at Chiba Tech. Previously Microsoft Research Cambridge. Worked at a bunch of start-ups in London.</p> <div class="flex gap-4 mt-3 justify-center md:justify-start"> <a href="https://www.henkaku.center/en/people/grisha-szep/" target="_blank" rel="noopener noreferrer" class="text-gray-900 dark:text-white hover:text-gray-600 dark:hover:text-gray-300 text-sm"> Henkaku Center </a> <a href="https://github.com/gszep" target="_blank" rel="noopener noreferrer" class="text-gray-900 dark:text-white hover:text-gray-600 dark:hover:text-gray-300 text-sm">
GitHub
</a> <a href="https://linkedin.com/in/gszep" target="_blank" rel="noopener noreferrer" class="text-gray-900 dark:text-white hover:text-gray-600 dark:hover:text-gray-300 text-sm">
LinkedIn
</a> </div> </div> </div> </div> </footer>  <!-- Staging password gate --> <script>
    (function() {
      var STAGING_HOST = 'staging.gszep.com';
      var SESSION_KEY = 'staging-auth';
      var PASSWORD = 'preview';
      if (window.location.hostname !== STAGING_HOST) return;
      if (sessionStorage.getItem(SESSION_KEY) === 'ok') return;
      document.documentElement.style.visibility = 'hidden';
      document.addEventListener('DOMContentLoaded', function() {
        var overlay = document.createElement('div');
        overlay.style.cssText = 'position:fixed;inset:0;z-index:99999;background:#fff;display:flex;align-items:center;justify-content:center;font-family:sans-serif';
        overlay.innerHTML =
          '<form id="gate-form" style="text-align:center;max-width:320px;width:100%;padding:2rem">' +
          '<h2 style="margin:0 0 0.5rem;font-size:1.25rem;font-weight:600">Staging Preview</h2>' +
          '<p style="margin:0 0 1.5rem;color:#666;font-size:0.875rem">Enter password to continue</p>' +
          '<input id="gate-password" type="password" placeholder="Password" autofocus ' +
          'style="width:100%;padding:0.625rem;border:1px solid #ccc;border-radius:4px;font-size:1rem;margin-bottom:0.75rem;box-sizing:border-box">' +
          '<button type="submit" style="width:100%;padding:0.625rem;background:#333;color:#fff;border:none;border-radius:4px;font-size:1rem;cursor:pointer">Enter</button>' +
          '<p id="gate-error" style="color:#c00;margin:0.75rem 0 0;font-size:0.875rem;display:none">Incorrect password</p>' +
          '</form>';
        document.body.appendChild(overlay);
        document.documentElement.style.visibility = 'visible';
        document.getElementById('gate-form').addEventListener('submit', function(e) {
          e.preventDefault();
          var input = document.getElementById('gate-password');
          if (input.value === PASSWORD) {
            sessionStorage.setItem(SESSION_KEY, 'ok');
            overlay.remove();
            window.location.reload();
          } else {
            document.getElementById('gate-error').style.display = 'block';
            input.value = '';
            input.focus();
          }
        });
      });
    })();
    </script> </body> </html>