<!DOCTYPE html><html lang="ja"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="白血球の表面は、体外由来のタンパク質にのみ適合する三次元パズルピースのような受容体で覆われている。"><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet"><title>免疫受容体の設計 | grisha.log</title><!-- Theme detection: runs before render to prevent flash --><script>
      (function() {
        var stored = localStorage.getItem('theme');
        if (stored === 'dark' || (!stored && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark');
        }
      })();
    </script><link rel="stylesheet" href="/_astro/_slug_.YteoUFBk.css">
<style>:root{--post-text: #353535;--post-heading: #1a1a1a;--post-strong: #1a1a1a;--post-link: #2563eb;--post-link-hover: #1d4ed8;--post-code-bg: #f5f5f5;--post-pre-bg: #f7f7f7;--post-blockquote-border: #d4d4d4;--post-blockquote-text: #737373;--post-caption: #737373;--post-aside-bg: #f5f5f5;--post-aside-text: #737373;--post-separator: #e5e5e5}.dark{--post-text: #d4d4d4;--post-heading: white;--post-strong: white;--post-link: #93c5fd;--post-link-hover: #bfdbfe;--post-code-bg: #1c1c1c;--post-pre-bg: #141414;--post-blockquote-border: #525252;--post-blockquote-text: #a3a3a3;--post-caption: #a3a3a3;--post-aside-bg: #1c1c1c;--post-aside-text: #a3a3a3;--post-separator: #404040}.l-body{max-width:700px;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem}.l-page{max-width:900px;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem}.post{overflow-x:hidden}.l-screen{width:100vw;position:relative;left:50%;right:50%;margin-left:-50vw;margin-right:-50vw}.post-content figure.l-screen{margin-left:-50vw;margin-right:-50vw}.post-content{color:var(--post-text);line-height:1.8;font-size:1.125rem}.post-content h2{color:var(--post-heading);font-size:1.75rem;font-weight:700;margin-top:2.5rem;margin-bottom:1rem}.post-content h3{color:var(--post-heading);font-size:1.375rem;font-weight:600;margin-top:2rem;margin-bottom:.75rem}.post-content p{margin-bottom:1.25rem}.post-content strong{color:var(--post-strong);font-weight:600}.post-content a{color:var(--post-link);text-decoration:underline;text-underline-offset:2px}.post-content a:hover{color:var(--post-link-hover)}.post-content code{background:var(--post-code-bg);padding:.15rem .4rem;border-radius:.25rem;font-size:.9em}.post-content pre{background:var(--post-pre-bg);border-radius:.5rem;padding:1.25rem;overflow-x:auto;margin-bottom:1.25rem}.post-content pre code{background:none;padding:0}.dark .astro-code,.dark .astro-code span{color:var(--shiki-dark)!important;background-color:var(--shiki-dark-bg)!important}.post-content blockquote{border-left:3px solid var(--post-blockquote-border);padding-left:1rem;color:var(--post-blockquote-text);margin-bottom:1.25rem}.post-content ul,.post-content ol{padding-left:1.5rem;margin-bottom:1.25rem}.post-content li{margin-bottom:.5rem}.post-content img{border-radius:.25rem}.post-content figure{margin:2.5rem auto;text-align:center}.post-content figure:not(.l-body):not(.l-page):not(.l-screen){max-width:900px;position:relative;width:90vw;left:50%;transform:translate(-50%)}@media(min-width:940px){.post-content figure:not(.l-body):not(.l-page):not(.l-screen){width:900px}}.post-content figure img,.post-content figure video{margin-left:auto;margin-right:auto;margin-bottom:.75rem;max-width:100%;height:auto;border-radius:.25rem}.post-content figcaption{font-size:.85rem;color:var(--post-caption);line-height:1.5;text-align:center;max-width:540px;margin:0 auto}.post-content>p>img{display:block;margin:2rem auto;max-width:100%}.aside-container{position:relative}@media(min-width:1200px){.aside-note{position:absolute;right:-280px;width:240px;font-size:.85rem;color:var(--post-aside-text);line-height:1.5}}@media(max-width:1199px){.aside-note{background:var(--post-aside-bg);border-radius:.5rem;padding:.75rem 1rem;margin-bottom:1.25rem;font-size:.9rem;color:var(--post-aside-text)}}.post-content .katex{color:inherit}.post-separator{border:none;border-top:1px solid var(--post-separator)}
</style></head> <body class="bg-white dark:bg-black text-gray-900 dark:text-white font-sans min-h-screen">  <nav class="fixed top-0 w-full bg-white dark:bg-black z-50" role="navigation" aria-label="main navigation" data-lang="ja"> <div class="max-w-6xl mx-auto px-4 flex items-center justify-between h-16"> <a href="/ja/" class="font-bold text-gray-900 dark:text-white text-lg">grisha.log</a> <!-- Desktop nav --> <div class="hidden md:flex items-center gap-6 text-sm uppercase tracking-wide"> <a href="/ja/" data-section="hero" class="nav-link text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">ホーム</a> <a href="/ja/#blog" data-section="blog" class="nav-link text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">ブログ</a> <a href="/ja/#contact" data-section="contact" class="nav-link text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">連絡先</a> <a href="/blog/designing-immune-receptors/" aria-label="Switch to English" class="p-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"> <span class="block w-5 h-5 leading-5 text-center text-xs font-bold">EN</span> </a> <button type="button" aria-label="ダークモード切替" class="theme-toggle p-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"> <!-- Sun (shown in dark mode: click to go light) --> <svg class="hidden dark:block w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path> </svg> <!-- Moon (shown in light mode: click to go dark) --> <svg class="block dark:hidden w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path> </svg> </button> <script type="module">document.querySelectorAll(".theme-toggle").forEach(e=>{e.addEventListener("click",()=>{const t=document.documentElement.classList.toggle("dark");localStorage.setItem("theme",t?"dark":"light")})});</script> </div> <!-- Mobile: toggle + burger --> <div class="flex items-center gap-2 md:hidden"> <a href="/blog/designing-immune-receptors/" aria-label="Switch to English" class="p-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"> <span class="block w-5 h-5 leading-5 text-center text-xs font-bold">EN</span> </a> <button type="button" aria-label="ダークモード切替" class="theme-toggle p-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"> <!-- Sun (shown in dark mode: click to go light) --> <svg class="hidden dark:block w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path> </svg> <!-- Moon (shown in light mode: click to go dark) --> <svg class="block dark:hidden w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path> </svg> </button>  <button class="text-gray-900 dark:text-white" id="nav-burger" aria-label="ナビゲーション切替" aria-expanded="false"> <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path> </svg> </button> </div> </div> <!-- Mobile menu --> <div class="hidden md:hidden bg-white dark:bg-black px-4 pb-4" id="nav-menu"> <a href="/ja/" data-section="hero" class="nav-link block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">ホーム</a> <a href="/ja/#blog" data-section="blog" class="nav-link block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">ブログ</a> <a href="/ja/#contact" data-section="contact" class="nav-link block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">連絡先</a> </div> </nav> <script type="module">const o=document.getElementById("nav-burger"),i=document.getElementById("nav-menu");o?.addEventListener("click",()=>{i?.classList.toggle("hidden");const t=o.getAttribute("aria-expanded")==="true";o.setAttribute("aria-expanded",String(!t))});i?.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>{i.classList.add("hidden"),o?.setAttribute("aria-expanded","false")})});const l=document.querySelectorAll(".nav-link");function c(t){l.forEach(n=>{const e=n.dataset.section===t;n.classList.toggle("text-gray-900",e),n.classList.toggle("dark:text-white",e),n.classList.toggle("text-gray-500",!e),n.classList.toggle("dark:text-gray-400",!e)})}const r=["/","/ja/","/ja"],g=r.includes(window.location.pathname),d=["hero","blog","contact"],s=g?d.map(t=>document.getElementById(t)).filter(Boolean):[];if(s.length===d.length){let t=function(){const n=window.scrollY+window.innerHeight*.35;let e=s[0].id;for(const a of s)a.offsetTop<=n&&(e=a.id);window.innerHeight+window.scrollY>=document.body.offsetHeight-2&&(e="contact"),c(e)};window.addEventListener("scroll",t,{passive:!0}),t()}else window.location.pathname.includes("/blog")&&c("blog");</script> <article class="post"> <header class="l-body pt-32 pb-8"> <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-4 tracking-tight">免疫受容体の設計</h1> <p class="text-gray-600 dark:text-gray-400 text-lg leading-relaxed mb-4">白血球の表面は、体外由来のタンパク質にのみ適合する三次元パズルピースのような受容体で覆われている。</p> <div class="flex items-center gap-4 text-gray-500 text-sm"> <time datetime="2023-11-01T00:00:00.000Z">2023年11月1日</time> <div class="flex gap-2"> <span class="bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-xs">免疫学</span><span class="bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-xs">機械学習</span><span class="bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-xs">タンパク質設計</span><span class="bg-gray-200 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-2 py-1 rounded text-xs">Blender</span> </div> </div> </header> <div class="post-content l-body">  <h3 id="がんのシグナルは腫瘍細胞の表面に現れることがある">がんのシグナルは腫瘍細胞の表面に現れることがある</h3>
<p>健康な細胞は、ペプチドと呼ばれるタンパク質の断片を表面に提示している。これらのペプチドはMHCという分子に保持されている。細胞が腫瘍細胞のように振る舞う変異を獲得すると、その変異がMHCに提示される可能性がある。こうなると、白血球は表面の受容体で変異ペプチドを認識するチャンスを得る。</p>
<figure><img src="/images/pmhc-2.png" width="128" alt="pMHCバリアント2"/><img src="/images/pmhc-3.png" width="128" alt="pMHCバリアント3"/><img src="/images/pmhc-4.png" width="128" alt="pMHCバリアント4"/><img src="/images/pmhc-5.png" width="128" alt="pMHCバリアント5"/><figcaption>変異（黒）がMHC分子（シアン）に提示されるペプチド（白）に現れる</figcaption></figure>
<h3 id="がんシグナルに適合し健康な細胞には適合しない受容体の設計は難しい">がんシグナルに適合し、健康な細胞には適合しない受容体の設計は難しい</h3>
<p>変異ペプチドに結合し、健康なバリアントには結合しない白血球受容体を見つけるのは困難だ。健康なものとがん性のものの間にはアミノ酸1つの違いしかないことが多いからだ。健康なバリアントに結合する細胞があると、健康な細胞を攻撃して自己免疫反応を引き起こすリスクがある。</p>
<p>ここでAIを使って白血球受容体配列の探索空間をナビゲートできる（<a href="https://openreview.net/forum?id=YOGss3XXp0">L. Cornwall, G. Szep et al. 2023</a>）。MHCの表面に最適なアミノ酸を予測するモデルを訓練すれば、病気の細胞を認識する受容体のループ領域におけるアミノ酸配列の探索空間を絞り込める。</p>
<figure><img src="/images/tcr-1.png" width="128" alt="TCRバリアント1"/><img src="/images/tcr-2.png" width="128" alt="TCRバリアント2"/><img src="/images/tcr-3.png" width="128" alt="TCRバリアント3"/><img src="/images/tcr-4.png" width="128" alt="TCRバリアント4"/><figcaption>AIの助けを借りて、MHC上に提示された変異ペプチドの形状に適合する白血球受容体（赤）を生成</figcaption></figure>
<h3 id="blenderで組合せ複雑性を可視化する">Blenderで組合せ複雑性を可視化する</h3>
<p>生成モデルは以下のような<a href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/tutorials/pdbintro.html">PDBファイル</a>を出力する。</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto" tabindex="0" data-language="plaintext"><code><span class="line"><span>ATOM      1  N   GLY A   1     -17.507  12.508  39.735  1.00 56.47           N</span></span>
<span class="line"><span>ATOM      2  CA  GLY A   1     -16.155  12.561  40.353  1.00 60.73           C</span></span>
<span class="line"><span>ATOM      3  C   GLY A   1     -15.103  12.063  39.385  1.00 59.90           C</span></span>
<span class="line"><span>ATOM      4  O   GLY A   1     -15.449  11.565  38.306  1.00 61.33           O</span></span>
<span class="line"><span>ATOM      5  N   SER A   2     -13.833  12.192  39.769  1.00 56.73           N</span></span>
<span class="line"><span>...</span></span></code></pre>
<p>各行に原子の座標、原子種、どの鎖とアミノ酸に属するかが入っている。<a href="https://bradyajohnston.github.io/MolecularNodes/">Molecular Nodes</a>アドオンを使えばこれらのファイルをBlenderにインポートできる。PDBファイルの情報を使って、Geometry Nodesで好きなプロパティをレンダリングできるわけだ。</p>
<h3 id="参考文献">参考文献</h3>
<p>L. Cornwall, G. Szep et al. 2023. NeurIPS Generative AI &amp; Biology Workshop. Fine-tuned protein language models capture T cell receptor stochasticity</p>
<p>B.A. Johnston. 2024. MolecularNodes. zenodo.org/records/11483365</p>  </div> <div class="l-body pb-16 pt-12"> <hr class="post-separator"> </div> </article> <footer id="contact" class="bg-gray-100 dark:bg-gray-800" style="scroll-margin-top: 4rem;"> <div class="max-w-6xl mx-auto px-4 py-12"> <div class="flex flex-col md:flex-row items-center md:items-start gap-6"> <img src="/images/headshot.jpg" alt="グリシャ・セップ" class="w-16 h-16 rounded-full object-cover"> <div class="text-center md:text-left"> <h3 class="text-gray-900 dark:text-gray-300 font-medium">グリシャ・セップ</h3> <p class="text-gray-500 text-sm mt-1 max-w-lg">千葉工大でコグニティブサイバーウェアをつくっている。前職はMicrosoft Research Cambridge。ロンドンのスタートアップをいくつか渡り歩いた。</p> <div class="flex gap-4 mt-3 justify-center md:justify-start"> <a href="https://www.henkaku.center/ja/people/grisha-szep/" target="_blank" rel="noopener noreferrer" class="text-gray-900 dark:text-white hover:text-gray-600 dark:hover:text-gray-300 text-sm"> 変革センター </a> <a href="https://github.com/gszep" target="_blank" rel="noopener noreferrer" class="text-gray-900 dark:text-white hover:text-gray-600 dark:hover:text-gray-300 text-sm">
GitHub
</a> <a href="https://linkedin.com/in/gszep" target="_blank" rel="noopener noreferrer" class="text-gray-900 dark:text-white hover:text-gray-600 dark:hover:text-gray-300 text-sm">
LinkedIn
</a> </div> </div> </div> </div> </footer>  <!-- Staging password gate --> <script>
    (function() {
      var STAGING_HOST = 'staging.gszep.com';
      var SESSION_KEY = 'staging-auth';
      var PASSWORD = 'preview';
      if (window.location.hostname !== STAGING_HOST) return;
      if (sessionStorage.getItem(SESSION_KEY) === 'ok') return;
      document.documentElement.style.visibility = 'hidden';
      document.addEventListener('DOMContentLoaded', function() {
        var overlay = document.createElement('div');
        overlay.style.cssText = 'position:fixed;inset:0;z-index:99999;background:#fff;display:flex;align-items:center;justify-content:center;font-family:sans-serif';
        overlay.innerHTML =
          '<form id="gate-form" style="text-align:center;max-width:320px;width:100%;padding:2rem">' +
          '<h2 style="margin:0 0 0.5rem;font-size:1.25rem;font-weight:600">Staging Preview</h2>' +
          '<p style="margin:0 0 1.5rem;color:#666;font-size:0.875rem">Enter password to continue</p>' +
          '<input id="gate-password" type="password" placeholder="Password" autofocus ' +
          'style="width:100%;padding:0.625rem;border:1px solid #ccc;border-radius:4px;font-size:1rem;margin-bottom:0.75rem;box-sizing:border-box">' +
          '<button type="submit" style="width:100%;padding:0.625rem;background:#333;color:#fff;border:none;border-radius:4px;font-size:1rem;cursor:pointer">Enter</button>' +
          '<p id="gate-error" style="color:#c00;margin:0.75rem 0 0;font-size:0.875rem;display:none">Incorrect password</p>' +
          '</form>';
        document.body.appendChild(overlay);
        document.documentElement.style.visibility = 'visible';
        document.getElementById('gate-form').addEventListener('submit', function(e) {
          e.preventDefault();
          var input = document.getElementById('gate-password');
          if (input.value === PASSWORD) {
            sessionStorage.setItem(SESSION_KEY, 'ok');
            overlay.remove();
            window.location.reload();
          } else {
            document.getElementById('gate-error').style.display = 'block';
            input.value = '';
            input.focus();
          }
        });
      });
    })();
    </script> </body> </html>